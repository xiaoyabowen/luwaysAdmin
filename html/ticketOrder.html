<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>后台主题UI框架</title>
    <meta name="keywords">
    <meta name="description">
    <meta name="keywords">
    <meta name="description">
    <!--网页logo-->
    <link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />

    <link href="../resource/css/common.css" rel="stylesheet">
    <link href="../resource/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="../resource/css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="../resource/js/plugins/select2/css/select2.css" rel="stylesheet">
    <link href="../resource/js/plugins/bootstarp-table/css/bootstrap-table.min.css" rel="stylesheet">
    <link href="../resource/css/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css" rel="stylesheet">
    <link href="../resource/css/animate.css" rel="stylesheet">
    <link href="../resource/css/style.css?v=4.1.0" rel="stylesheet">
    <!--iCheck样式-->
    <link rel="stylesheet" type="text/css" href="../resource/css/plugins/iCheck/custom.css" />
</head>
<style>
    .table {
        table-layout: fixed;
    }

    .inputClass {
        display: inline-block;
        width: 50px;
    }

    .tableClass th,
    .tableClass td {
        text-align: center;
    }

    #toolbar {
        width: 1000px;
    }

    .labelSelect {
        display: flex;
    }

    .distribution {
        display: none;
    }

    em {
        font-style: normal;
    }

    .W120 .th-inner {
        width: 120px !important;
    }
</style>

<body class="gray-bg">




    <!--编辑  motal-->
    <div class="wrapper wrapper-content animated  fadeInDown  content-view  ">

        <form method="get" class="form-horizontal" id="areaForm">
            <div class="form-group">
                <label class="col-sm-3 control-label">账户名*</label>
                <div class="col-sm-8">
                    <input type="hidden" class="form-control hiddenid" id="id">
                    <input type="text" class="form-control" id="username" placeholder="请输入公司名字" />
                    <span class="help-block m-b-none validate"></span>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">公司名*</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" id="name" placeholder="请输入公司名">
                </div>

            </div>
            <div class="form-group">

                <label class="col-sm-3 control-label">所属集团*</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" id="channelType" placeholder="请输入所属集团">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">联系人</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" id="lkm" placeholder="请输入联系人">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">联系电话</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" id="lkmPhone" placeholder="请输入联系电话">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">联系邮箱</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" id="lkmEmail" placeholder="请输入联系邮箱">
                </div>
            </div>

            <div class="form-group">

                <label class="col-sm-3 control-label">公司性质</label>
                <div class="col-sm-8">
                    <select class="property form-control">

                    </select>
                </div>
            </div>

            <div class="form-group">

                <label class="col-sm-3 control-label">渠道类型</label>
                <div class="col-sm-8">
                    <select class="channelType form-control">
                        <option value="1">普通门店</option>
                        <option value="2">组团社</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">渠道利润率</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" id="profit" placeholder="请输入联系邮箱">
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">负责人</label>
                <div class="col-sm-8">
                    <select class="manager form-control">
                        <option value="叶湘凡">叶湘凡</option>
                        <option value="李琪琦">李琪琦</option>
                        <option value="周娜">周娜</option>
                        <option value="赵雅琦">赵雅琦</option>
                        <option value="丁熳熳">丁熳熳</option>
                        <option value="刘洋">刘洋</option>
                        <option value="Robbie">Robbie</option>
                        <option value="Jacob Goering">Jacob Goering</option>
                    </select>
                </div>
            </div>

        </form>
    </div>


    <div class="wrapper wrapper-content animated fadeInRight">
        <!-- Panel Other -->
        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>供应商管理</h5>
            </div>
            <div class="ibox-content">
                <div class="row row-lg">
                    <div class="col-sm-12">
                        <div id="toolbar">
                            <div class="col-sm-2">
                                <select class="orderType form-control" id="orderType">
                                    <option value="">全部</option>
                                    <option value="3">Viator直连</option>
                                    <option value="2">Voucher</option>
                                    <option value="1">酒店</option>
                                    <option value="0">门票</option>
                                </select>
                            </div>
                            <div class="col-sm-3">
                                <select class="orderFrom form-control">
                                    <option value="">门票订单：全部</option>
                                    <option value="0">自己平台</option>
                                    <option value="1">蚂蜂窝</option>
                                    <option value="3">蚂蜂窝(new)</option>
                                    <option value="2">新美大</option>
                                </select>
                            </div>

                            <div class="form-group labelSelect col-sm-4">
                                <input type="text" class="col-sm-12 form-control" id="keywords"
                                    placeholder="产品ID、Hotelbeds url、产品关键字、更新人">
                            </div>
                            <div class="form-group col-sm-1">
                                <button class="btn btn-primary  btn-outline" id="btn_search">
                                    <i class="fa fa-search">搜索</i>
                                </button>
                            </div>
                        </div>

                        <table id="tb_table"></table>
                    </div>
                </div>
            </div>
        </div>
        <!--文档表单-->
        <form style="opacity: 0" action="" class="wordForm" autocomplete="off" enctype="multipart/form-data">
            <input type="hidden" name="orderFrom" id="orderFromFile">
            <input type="hidden" id="orderNoFile" name="orderId">
            <input style="height: 0;width: 0;" type="file" name="myfiles" accept=".pdf" />
        </form>
        <!-- End Panel Other -->
    </div>

    <!-- 全局js -->
    <script src="../resource/js/jquery.min.js?v=2.1.4"></script>
    <script src="../resource/js/bootstrap.min.js?v=3.3.6"></script>
    <!-- 自定义js -->
    <script src="../resource/js/content.js?v=1.0.0"></script>

    <script src="../resource/js/plugins/select2/js/select2.full.js"></script>
    <script src="../resource/js/plugins/select2/js/i18n/zh-CN.js"></script>
    <script src="../resource/js/plugins/layer/layer.js"></script>
    <script src="../resource/js/plugins/laydate/laydate.js"></script>
    <!-- ztree -->
    <!-- Bootstrap table -->
    <script src="../resource/js/plugins/bootstarp-table/js/bootstrap-table.js"></script>
    <script src="../resource/js/plugins/bootstarp-table/js/bootstrap-table-zh-CN.min.js"></script>

    <script src="../resource/js/plugins/bootstrap-3-typeahead/bootstrap3-typeahead.js"></script>

    <script src="../resource/common/multiselect.js"></script>
    <script src="../resource/common/common.js?time=" +Math.random()></script>

    <!--多选框 icheck.js-->
    <script src="../resource/js/plugins/iCheck/iCheck.js"></script>

    <script>
        // for (var i=0;i<getUserInfo().roles[0].resources.length;i++){
        //     if (getUserInfo().roles[0].resources[i].permission == 100003005){
        //         $("#toolbar").show()
        //     }
        // }

        var $table = $('#tb_table');

        function Table() {
            $table.bootstrapTable({
                url: adminOrderRestfulControllerList, //请求后台的URL（*）
                method: 'get', //请求方式（*）
                contentType: "application/x-www-form-urlencoded",
                toolbar: '#toolbar', //工具按钮用哪个容器
                //                    striped: true,                      //是否显示行间隔色
                cache: false, //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                pagination: true, //是否显示分页（*）
                sortable: true, //是否启用排序
                sortOrder: "asc", //排序方式
                sidePagination: "server", //分页方式：client客户端分页，server服务端分页（*）
                pageNumber: 1, //初始化加载第一页，默认第一页
                pageSize: 10, //每页的记录行数（*）
                pageList: 5, //分页步进值
                pageList: [10, 20, 30, 50], //可供选择的每页的行数（*）
                //                search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大
                strictSearch: true,
                showColumns: false,
                showRefresh: false,
                minimumCountColumns: 2, //最少允许的列数
                clickToSelect: true, //是否启用点击选中行
                //				height: 500,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
                uniqueId: "id", //每一行的唯一标识，一般为主键列
                //                showToggle:true,                    //是否显示详细视图和列表视图的切换按钮
                cardView: false, //是否显示详细视图
                detailView: false, //是否显示父子表
                //                    showFooter:true,            //表格底部
                onClickRow: function (row) {
                    // console.log(row)
                },
                queryParamsType: 'limit',
                queryParams: function (params) {

                    return {
                        pageNo: (params.offset / params.limit) + 1,
                        pageSize: params.limit,
                        // keywords: keywords,
                        keywords: $("#keywords").val(),
                        orderType: $(".orderType").val(),
                        orderFrom: $(".orderFrom").val(),
                    };
                },
                onLoadSuccess: function (data) {
                    console.log(data)
                },
                responseHandler: function (e) {
                    // console.log(e)
                    return {
                        "rows": e.data.list.list,
                        "total": e.data.list.total
                    };

                },
                columns: [{
                        field: "title",
                        title: "加急/是否处理",
                        formatter: function (value, row, index) {
                            var data = row
                            var hotConfim = ''
                            if (row.orderFrom == 2) {

                                if ($.inArray("100003004", arrayHtml) !== -1) {
                                    // hotConfim += '<a  class="btn btn-primary btn-sm btn-outline deleteData" href="javascript:void(0)" onclick=\'hotBtnConfim(' + data.id + ')\' style="margin-right: 2px"><i class="fa fa-fire"></i>加急</a>'
                                    hotConfim +=
                                        '<a  class="btn-primaryEdit deleteData" style="display: inline-block" href="javascript:void(0)" onclick=\'refundBtn(' +
                                        JSON.stringify(data) + ')\'>退款</a>'
                                    hotConfim += '&nbsp;'
                                } else {
                                    hotConfim += '&nbsp';
                                }
                                if ($.inArray("100003003", arrayHtml) !== -1) {
                                    hotConfim +=
                                        '<a  class="btn-successEdit deleteData" style="display: inline-block" href="javascript:void(0)" onclick=\'canHandle(' +
                                        data.id + ')\'>可处理</a>'
                                    hotConfim += '&nbsp;'
                                } else {
                                    hotConfim += '&nbsp';
                                }
                                if ($.inArray("100003002", arrayHtml) !== -1) {
                                    hotConfim +=
                                        '<a  class="btn-dangerEdit deleteData" style="display: inline-block" href="javascript:void(0)" onclick=\'notHandle(' +
                                        JSON.stringify(data) + ')\'>暂不处理</a>'
                                    hotConfim += '&nbsp;'
                                } else {
                                    hotConfim += '&nbsp';
                                }
                                if ($.inArray("100003007", arrayHtml) !== -1) {
                                    hotConfim +=
                                        '<a  class="btn-dangerEdit deleteData" style="display: inline-block" href="javascript:void(0)" onclick=\'cancelBtn(' +
                                        JSON.stringify(data) + ')\'>取消</a>'
                                    hotConfim += '&nbsp;'
                                } else {
                                    hotConfim += '&nbsp';
                                }
                            } else {
                                if ($.inArray("100003004", arrayHtml) !== -1) {
                                    // hotConfim += '<a  class="btn btn-primary btn-sm btn-outline deleteData" href="javascript:void(0)" onclick=\'hotBtnConfim(' + data.id + ')\' style="margin-right: 2px"><i class="fa fa-fire"></i>加急</a>'
                                    hotConfim +=
                                        '<a  class="btn-primaryEdit deleteData" style="display: inline-block" href="javascript:void(0)" onclick=\'refundBtn(' +
                                        JSON.stringify(data) + ')\' style="margin-right: 2px">退款</a>'
                                    hotConfim += '&nbsp;'
                                } else {
                                    hotConfim += '&nbsp';
                                }
                                if ($.inArray("100003003", arrayHtml) !== -1) {
                                    hotConfim +=
                                        '<a  class="btn-successEdit deleteData" style="display: inline-block" href="javascript:void(0)" onclick=\'canHandle(' +
                                        data.id + ')\' style="margin-right: 2px">可处理</a>'
                                    hotConfim += '&nbsp;'
                                } else {
                                    hotConfim += '&nbsp';
                                }
                                if ($.inArray("100003002", arrayHtml) !== -1) {
                                    hotConfim +=
                                        '<a  class="btn-dangerEdit deleteData" style="display: inline-block" href="javascript:void(0)" onclick=\'notHandle(' +
                                        JSON.stringify(data) + ')\'>暂不处理</a>'
                                    hotConfim += '&nbsp;'
                                } else {
                                    hotConfim += '&nbsp';
                                }



                            }
                            return hotConfim;

                        }
                    },
                    {
                        field: "name",
                        cellStyle: {
                            css: {
                                "word-wrap": "break-word",
                            }
                        },
                        width: 200,
                        title: "渠道订单号<br />供应商订单号",
                        formatter: function (value, row, index) {
                            var questionHtml = ''
                            if (row.orderStatus == 12) {
                                if (row.orderFrom == 1) {
                                    questionHtml += '<a style="color: red" onclick="orderInfoTrave(' +
                                        row.id + ',1)">' + row.orderNo + '</a>'
                                    questionHtml += '<br />'
                                    questionHtml += '<a>' + row.sourceReference + '</a>'

                                    if (row.checkDate == null) {
                                        questionHtml += ''
                                    } else {
                                        questionHtml += '<br />'
                                        questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                            .checkDate + '</em>'
                                    }
                                } else if (row.orderFrom == 0) {
                                    questionHtml += '<a style="color: red"  onclick="orderInfoTrave(' +
                                        row.id + ',0)">' + row.orderNo + '</a>'
                                    questionHtml += '<br />'
                                    questionHtml += '<a>' + row.sourceReference + '</a>'
                                    if (row.checkDate == null) {
                                        questionHtml += ''
                                    } else {
                                        questionHtml += '<br />'
                                        questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                            .checkDate + '</em>'
                                    }
                                } else if (row.orderFrom == 2) {
                                    questionHtml += '<a style="color: red" onclick="orderInfoTrave(' +
                                        row.id + ',2)">' + row.orderNo + '</a>'
                                    questionHtml += '<br />'
                                    questionHtml += '<a>' + row.sourceReference + '</a>'
                                    if (row.checkDate == null) {
                                        questionHtml += ''
                                    } else {
                                        questionHtml += '<br />'
                                        questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                            .checkDate + '</em>'
                                    }
                                } else if (row.orderFrom == 3) {
                                    questionHtml += '<a style="color: red"  onclick="orderInfoTrave(' +
                                        row.id + ',3)">' + row.orderNo + '</a>'
                                    questionHtml += '<br />'
                                    questionHtml += '<a>' + row.sourceReference + '</a>'
                                    if (row.checkDate == null) {
                                        questionHtml += ''
                                    } else {
                                        questionHtml += '<br />'
                                        questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                            .checkDate + '</em>'
                                    }
                                }
                            } else if (row.orderStatus == 4) {
                                if (row.orderFrom == 1) {
                                    questionHtml +=
                                        '<a class="textWrap" style="color: red" onclick="orderInfoTrave(' +
                                        row.id + ',1)">' + row.orderNo + '</a>'
                                    questionHtml += '<br />'
                                    questionHtml += '<a>' + row.sourceReference + '</a>'
                                    if (row.checkDate == null) {
                                        questionHtml += ''
                                    } else {
                                        questionHtml += '<br />'
                                        questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                            .checkDate + '</em>'
                                    }
                                } else if (row.orderFrom == 0) {
                                    questionHtml += '<a onclick="orderInfoTrave(' + row.id + ',0)">' +
                                        row.orderNo + '</a>'
                                    questionHtml += '<br />'
                                    questionHtml += '<a>' + row.sourceReference + '</a>'
                                    if (row.checkDate == null) {
                                        questionHtml += ''
                                    } else {
                                        questionHtml += '<br />'
                                        questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                            .checkDate + '</em>'
                                    }
                                } else if (row.orderFrom == 2) {
                                    questionHtml += '<a style="color: red" onclick="orderInfoTrave(' +
                                        row.id + ',2)">' + row.orderNo + '</a>'
                                    questionHtml += '<br />'
                                    questionHtml += '<a>' + row.sourceReference + '</a>'
                                    if (row.checkDate == null) {
                                        questionHtml += ''
                                    } else {
                                        questionHtml += '<br />'
                                        questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                            .checkDate + '</em>'
                                    }
                                } else if (row.orderFrom == 3) {
                                    questionHtml += '<a onclick="orderInfoTrave(' + row.id + ',3)">' +
                                        row.orderNo + '</a>'
                                    questionHtml += '<br />'
                                    questionHtml += '<a>' + row.sourceReference + '</a>'
                                    if (row.checkDate == null) {
                                        questionHtml += ''
                                    } else {
                                        questionHtml += '<br />'
                                        questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                            .checkDate + '</em>'
                                    }
                                }
                            } else if (row.orderFrom == 0) {
                                questionHtml += '<a onclick="orderInfoTrave(' + row.id + ',0)">' + row
                                    .orderNo + '</a>'
                                questionHtml += '<br />'
                                questionHtml += '<a>' + row.sourceReference + '</a>'
                                if (row.checkDate == null) {
                                    questionHtml += ''
                                } else {
                                    questionHtml += '<br />'
                                    questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                        .checkDate + '</em>'
                                }
                            } else if (row.orderFrom == 1) {
                                questionHtml += '<a onclick="orderInfoTrave(' + row.id + ',1)">' + row
                                    .orderNo + '</a>'
                                questionHtml += '<br />'
                                questionHtml += '<a>' + row.sourceReference + '</a>'
                                if (row.checkDate == null) {
                                    questionHtml += ''
                                } else {
                                    questionHtml += '<br />'
                                    questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                        .checkDate + '</em>'
                                }
                            } else if (row.orderFrom == 2) {
                                questionHtml += '<a onclick="orderInfoTrave(' + row.id + ',2)">' + row
                                    .orderNo + '</a>'
                                questionHtml += '<br />'
                                questionHtml += '<a>' + row.sourceReference + '</a>'
                                if (row.checkDate == null) {
                                    questionHtml += ''
                                } else {
                                    questionHtml += '<br />'
                                    questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                        .checkDate + '</em>'
                                }
                            } else if (row.orderFrom == 3) {
                                questionHtml += '<a onclick="orderInfoTrave(' + row.id + ',3)">' + row
                                    .orderNo + '</a>'
                                questionHtml += '<br />'
                                questionHtml += '<a>' + row.sourceReference + '</a>'
                                if (row.checkDate == null) {
                                    questionHtml += ''
                                } else {
                                    questionHtml += '<br />'
                                    questionHtml += '<em style="color:#ff0000;">最晚确认时间：' + row
                                        .checkDate + '</em>'
                                }
                            }

                            return questionHtml;
                        }
                    },
                    {
                        field: "name",
                        width: 60,
                        title: "渠道<br />供应商",
                        formatter: function (value, row, index) {
                            var orderFromHtml = '';
                            var supplierHtml = '';

                            if (row.orderFrom == 0) {
                                orderFromHtml += "Luways"
                            } else if (row.orderFrom == 1) {
                                orderFromHtml += "蚂蜂窝"
                            } else if (row.orderFrom == 2) {
                                orderFromHtml += "新美大"
                            } else if (row.orderFrom == 3) {
                                orderFromHtml += "马蜂窝(new)"
                            }
                            if (row.supplier.name == null) {
                                supplierHtml += ''
                            } else {
                                supplierHtml += row.supplier.name
                            }


                            return orderFromHtml + "<br />" + supplierHtml;
                        }
                    },
                    {
                        field: "title",
                        width: 200,
                        title: "联系人<br />电话<br />邮箱",
                        formatter: function (value, row, index) {

                            return row.contractName + "<br />" + row.contractPhone + "<br />" + row
                                .contractEmail;
                        }
                    },
                    {
                        field: "onSale",
                        width: 240,
                        title: "产品<br />套餐Sku",
                        formatter: function (value, row, index) {
                            var productTitle = '';
                            var skuTitle = '';
                            if (row.orderStatus == 12) {
                                if (row.orderType == 3) {
                                    productTitle += row.productTitle
                                } else if (row.orderType == 11) {
                                    productTitle += '<span style="color: red;">' + row.productTitle +
                                        '</span>'
                                } else if (row.orderType == 0) {
                                    productTitle +=
                                        '<span  style="color: red;"><i class="fa fa-ticket" style="color: green"></i>' +
                                        row.productTitle + '</span>'
                                } else if (row.orderType == 1) {
                                    productTitle +=
                                        '<span  style="color: red;"><i class="fa fa-building" style="color: red"></i>' +
                                        row.productTitle + '</span>'
                                } else {
                                    productTitle += '<span style="color: red;">' + row.productTitle +
                                        '</span>'
                                }
                            } else {
                                if (row.orderType == 3) {
                                    productTitle += row.productTitle
                                } else if (row.orderType == 11) {
                                    productTitle += '<span style="color: red;">' + row.productTitle +
                                        '</span>'
                                } else if (row.orderType == 0) {
                                    productTitle +=
                                        '<span ><i class="fa fa-ticket" style="color: green"></i>' + row
                                        .productTitle + '</span>'
                                } else if (row.orderType == 1) {
                                    productTitle +=
                                        '<span ><i class="fa fa-building" style="color: red"></i>' + row
                                        .productTitle + '</span>'
                                } else {
                                    productTitle += row.productTitle
                                }
                            }



                            if (row.skuTitle == null) {
                                skuTitle += '-'
                            } else {
                                skuTitle += row.skuTitle
                            }

                            return productTitle + "<br />" + skuTitle;
                        }
                    },
                    {
                        field: "categories",
                        title: "下单日期<br />出行日期",
                        formatter: function (value, row, index) {
                            var startDateHtml = ''
                            if (row.startDate == null) {
                                startDateHtml += '-'
                            } else {
                                startDateHtml += row.startDate
                            }

                            return formatDateTime(row.createDate) + "<br />" + startDateHtml;
                        }
                    },
                    {
                        field: "cityName",
                        width: 60,
                        title: "金额",
                        formatter: function (value, row, index) {
                            return row.nowPrice;
                        }
                    },

                    {
                        field: "id",
                        width: 90,
                        title: "订单状态",
                        align: "center",
                        formatter: function (value, row, index) {
                            var data = row
                            var orderStatus = ''
                            if (row.orderStatus == 1) {
                                orderStatus +=
                                    '<a  class="btn btn-xs btn-info" href="javascript:void(0)" onclick=\'treatedConfirm(' +
                                    data.id + ')\'>待处理</a>'
                            } else if (row.orderStatus == 12) {
                                orderStatus +=
                                    '<a  class="btn btn-xs btn-danger" href="javascript:void(0)" onclick=\'hurryTreatedConfirm(' +
                                    data.id + ')\'>加急待处理</a>'
                            } else if (row.orderStatus == 2) {
                                orderStatus +=
                                    '<a  class="btn btn-warning btn-yellowEdit btn-xs" href="javascript:void(0)" onclick=\'hurryingConfirm(' +
                                    data.id + ')\'>处理中</a>'
                            } else if (row.orderStatus == 3) {
                                orderStatus +=
                                    '<a  class="btn btn-primary btn-xs" href="javascript:void(0)" onclick=\'sucssConfirm(' +
                                    data.id + ')\'>处理完成</a>'
                            } else if (row.orderStatus == 4) {
                                orderStatus +=
                                    '<a  class="btn btn-danger btn-xs" href="javascript:void(0)" style="cursor: default;">问题订单</a>'
                            } else if (row.orderStatus == 13) {
                                orderStatus +=
                                    '<a  class="btn btn-info btn-xs" href="javascript:void(0)" style="cursor: default;">已取消</a>'
                            } else if (row.orderStatus == 5) {
                                orderStatus +=
                                    '<a  class="btn btn-danger btn-xs" href="javascript:void(0)" style="cursor: default;">暂不处理</a>'
                            } else if (row.orderStatus == 19) {
                                orderStatus +=
                                    '<a  class="btn btn-danger btn-xs" href="javascript:void(0)" style="cursor: default;">已退款</a>'
                            }
                            return orderStatus;
                        }
                    },
                    {
                        field: "status",
                        cellStyle: {
                            css: {
                                "word-wrap": "break-word",
                            }
                        },
                        width: 100,
                        title: "备注",
                        formatter: function (value, row, index) {
                            var statusHtml = ''
                            if (row.remarks == null) {
                                statusHtml += '-'
                            } else {
                                statusHtml += '<em style="color: #ff9600;">' + row.remarks + '</em>'
                            }


                            return statusHtml;
                        }
                    },
                    {
                        field: "status",
                        title: "文件",
                        formatter: function (value, row, index) {
                            var statusHtml = ''
                            if (row.voucherStatus == 0) {
                                statusHtml +=
                                    '<a style="margin-right: 2px;display: inline-block" class="btn-infoEdit updateBtnToggle" onclick="uploadWord(\'' +
                                    row.orderNo + '\',' + row.orderFrom + ')">上传</button>'
                            } else if (row.voucherStatus == 2) {
                                statusHtml +=
                                    '<a style="margin-right: 2px;display: inline-block" class="btn-successEdit">已发送</a>'
                            } else {
                                statusHtml +=
                                    '<a style="margin-right: 2px;display: inline-block;" class="btn-primaryEdit sendBtnToggle" onclick="viocher(\'' +
                                    row.orderNo + '\',\'' + row.skuTitle + '\',\'' + row.contractEmail +
                                    '\')">发送</a>'
                            }
                            // statusHtml += '<a type="button" href="http://192.168.3.252:10909/upDownController/downloadFile/'+row.orderNo+'" class="btn btn-info" onclick="downWoad('+row.id+')">下载</a>'
                            statusHtml +=
                                '<a type="button" href="http://voucher.luways.com/upDownController/downloadFile/' +
                                row.orderNo + '" class="btn-successEdit" onclick="downWoad(' + row.id +
                                ')">下载</a>'
                            return statusHtml;
                        }
                    },
                ]
            });

        }

        //删除
        function deleteData(did) {
            console.log(did)
            var url = businessRestfulControllerDelete;
            var param = {
                id: did
            };
            var result = {
                succ: '删除成功!',
                fail: '删除失败'
            };
            layer.msg("确定要删除该消息？", {
                shade: [0.1, '##f5f5f5'],
                time: 0 //不自动关闭
                    ,
                btn: ['确定', '取消'],
                yes: function (index) {
                    layer.close(index);
                    myAjax(url, param, handle);

                    function handle(data, param) {
                        var msg = (data.msg == undefined ? '' : ',' + data.msg);
                        if (data.success) {
                            layer.msg(result.succ, {
                                icon: 1,
                                time: 1000,
                                shade: 0.01
                            });
                            handleTable(did, 4);
                        } else {
                            layer.msg(result.fail + msg, {
                                icon: 2,
                                time: 1000,
                                shade: 0.01
                            });
                        }
                    }
                },
                btn2: function (index, layero) {}
            });
        }

        //添加修改
        function addOrEdit(rowData) {
            var subType;
            if (isNotBlank(rowData)) {
                subType = 1;

            } else {
                subType = 0;
                // formReset();
            }
            var index = layer.open({
                type: 1,
                shade: 0.01,
                id: 'area', //设定一个id，防止重复弹出
                title: '添加/更新',
                area: ['600px', '400px'],
                content: $('.content-view'),
                btn: ['提交', '关闭'],
                yes: function (index) {
                    submitData(index, subType);
                },
                shadeClose: true, //开启遮罩关闭
                success: function () {

                    // 负责人  渲染人数
                    // 点击提交接口
                    myAjax(businessRestfulControllertoPage, '', handle)

                    function handle(data, params) {
                        var managerHtml = ''
                        var propertyHtml = ''
                        var managerData = data.data.usss;
                        var propertyData = data.data.queryPropertyList;

                        // 总负责人
                        for (var i = 0; i < managerData.length; i++) {
                            if (managerData[i].name == '') {
                                managerHtml += ''
                            } else {
                                managerHtml += '<option value="' + managerData[i].name + '">' + managerData[
                                    i].name + '</option>'
                            }

                        }
                        $(".manager").html(managerHtml)
                        // 渠道/
                        for (var j = 0; j < propertyData.length; j++) {

                            propertyHtml += '<option value="' + propertyData[j].info + '">' + propertyData[
                                j].info + '</option>'
                        }
                        $(".property").html(propertyHtml)
                    }



                    if (isNotBlank(rowData)) {
                        $('#id').val(rowData.id);
                        $('#username').val(rowData.masterUser.username);
                        $('#name').val(rowData.masterUser.name);
                        $('#lkm').val(rowData.lkm);
                        $('#lkmPhone').val(rowData.lkmPhone);
                        $('#lkmEmail').val(rowData.lkmEmail);
                        $('.property').val(rowData.property);
                        $('.channelType').val(rowData.channelType);
                        $('#profit').val(rowData.profit);
                        $('.manager').val(rowData.manager);
                    }
                }

            })
        }

        function submitData(index, type) {
            var id = $('#id').val();
            var username = $.trim($('#username').val());
            var name = $.trim($('#name').val());
            var lkm = $.trim($('#lkm').val());
            var lkmPhone = $.trim($('#lkmPhone').val());
            var lkmEmail = $.trim($('#lkmEmail').val());
            var property = $.trim($('.property').val());
            var channelType = $.trim($('.channelType').val());
            var profit = $.trim($('#profit').val());
            var manager = $.trim($('.manager').val());
            var result;
            var params = {};
            var url;
            if (type == 0) {
                url = businessRestfulControllerSave;

                result = {
                    succ: '添加成功！',
                    fail: '添加失败！'
                };
            } else {
                url = businessRestfulControllerSave;
                result = {
                    succ: '更新成功！',
                    fail: '更新失败'
                };
            }
            /*if(isBlank(title)){
                showValidate('#title');
                return  ;
            }
            if(isBlank(startDate)){
                showValidate('#pstartTime');
                return  ;
            }
            if(isBlank(endDate)){
                showValidate('#pendTime');
                return  ;
            }
            if(isBlank(tid)){
                tid=0;
            }*/

            if (isNotBlank(id)) {
                params.id = id;
            }

            layer.close(index);
            params.type = 2;
            params.username = username;
            params.name = name;
            params.lkm = lkm;
            params.lkmPhone = lkmPhone;
            params.lkmEmail = lkmEmail;
            params.property = property;
            params.channelType = channelType;
            params.profit = profit;
            params.manager = manager;
            myAjax(businessRestfulControllerSave, params, handle);

            function handle(data, params) {
                var msg = (data.msg == undefined ? '' : ',' + data.msg);
                if (data.success) {
                    layer.msg(result.succ, {
                        icon: 1,
                        time: 1000,
                        shade: 0.01
                    });
                    handleTable("", 3, businessRestfulControllerList);
                } else {
                    layer.msg(result.fail + msg, {
                        icon: 1,
                        ime: 1000,
                        shade: 0.01
                    });
                }
            }

        }


        // 加急btn
        /* function hotBtnConfim(sid) {
             console.log(sid)
             myAjax(orderUpdateOrderRequest,{cartId:sid,orderStatus:12,checkStatus:1}, handle)
             function handle(data,params) {
                 handleTable("",3,adminOrderRestfulControllerList);
             }
         }*/
        // 退款btn
        function refundBtn(sid) {
            console.log(sid)

            layer.msg("确定要退款吗？", {
                shade: [0.1, '##f5f5f5'],
                time: 0 //不自动关闭
                    ,
                btn: ['确定', '取消'],
                yes: function (index) {
                    layer.close(index);
                    myAjax(orderUpdateOrderRequest, {
                        cartId: sid.id,
                        orderStatus: 19,
                        orderNo: sid.orderNo
                    }, handle)

                    function handle(data, params) {
                        handleTable("", 3, adminOrderRestfulControllerList);
                    }
                },
                btn2: function (index, layero) {}
            });
        }
        // 可以处理
        function canHandle(sid) {

            layer.msg("确定要将订单可处理嘛？", {
                shade: [0.1, '##f5f5f5'],
                time: 0 //不自动关闭
                    ,
                btn: ['确定', '取消'],
                yes: function (index) {
                    layer.close(index);
                    myAjax(orderUpdateOrderRequest, {
                        cartId: sid,
                        orderStatus: 1
                    }, handle)

                    function handle(data, params) {
                        handleTable("", 3, adminOrderRestfulControllerList);
                    }
                },
                btn2: function (index, layero) {}
            });


        }
        // 不可以处理
        function notHandle(sid) {
            console.log(sid)
            layer.msg("确定要将订单暂不处理嘛？", {
                shade: [0.1, '##f5f5f5'],
                time: 0 //不自动关闭
                    ,
                btn: ['确定', '取消'],
                yes: function (index) {
                    layer.close(index);
                    myAjax(orderUpdateOrderRequest, {
                        cartId: sid.id,
                        orderStatus: 5
                    }, handle)

                    function handle(data, params) {
                        handleTable("", 3, adminOrderRestfulControllerList);
                    }
                },
                btn2: function (index, layero) {}
            });


        }

        // 手动确认
        function handConfirm(sid) {
            console.log(sid)
            myAjax(orderUpdateOrderRequest, {
                id: sid,
                orderStatus: 12
            }, handle)

            function handle(data, params) {
                handleTable("", 3, adminOrderRestfulControllerList);
            }
        }
        // 手动确认
        function hurryingConfirm(sid) {
            console.log(sid)
            myAjax(orderUpdateOrderRequest, {
                id: sid,
                orderStatus: 2
            }, handle)

            function handle(data, params) {
                handleTable("", 3, adminOrderRestfulControllerList);
            }
        }

        // 待处理
        function treatedConfirm(sid) {
            console.log("待处理" + sid)
            myAjax(orderUpdateOrderRequest, {
                id: sid,
                orderStatus: 1
            }, handle)

            function handle(data, params) {
                handleTable("", 3, adminOrderRestfulControllerList);
            }
        }

        // 加急待处理
        function hurryTreatedConfirm(sid) {
            console.log(sid)
            myAjax(orderUpdateOrderRequest, {
                id: sid,
                orderStatus: 1,
                checkStatus: 1
            }, handle)

            function handle(data, params) {
                handleTable("", 3, adminOrderRestfulControllerList);
            }
        }
        // 处理完成
        function sucssConfirm(sid) {
            console.log(sid)
            layer.msg("确定要处理成问题订单吗？", {
                shade: [0.1, '##f5f5f5'],
                time: 0 //不自动关闭
                    ,
                btn: ['确定', '取消'],
                yes: function (index) {
                    layer.close(index);
                    myAjax(orderUpdateOrderRequest, {
                        id: sid,
                        orderStatus: 3
                    }, handle)

                    function handle(data, params) {
                        handleTable("", 3, adminOrderRestfulControllerList);
                    }
                },
                btn2: function (index, layero) {}
            });


        }

        //取消新美大订单
        function cancelBtn(sid) {
            console.log(sid)
            layer.msg("确定要取消新美大的订单嘛？", {
                shade: [0.1, '##f5f5f5'],
                time: 0 //不自动关闭
                    ,
                btn: ['确定', '取消'],
                yes: function (index) {
                    layer.close(index);
                    myAjax(orderUpdateOrderRequestDp, {
                        otaOrderId: sid.orderNo,
                        orderStatus: 302
                    }, handle)

                    function handle(data, params) {
                        handleTable("", 3, adminOrderRestfulControllerList);
                    }
                },
                btn2: function (index, layero) {}
            });
        }

        // 上传成功之后  点击发送按钮
        function viocher(orderNo, skuTitle, contractEmail) {
            addReeMenuItem("../html/sendEmal.html?orderNo=" + orderNo + "&skuTitle=" + skuTitle + "&contractEmail=" +
                contractEmail, "发送邮箱");
        }


        // 订单处刑人详细信息  跳转
        function orderInfoTrave(sid, status) {
            if (status == 3) {
                // 蚂蜂窝new
                addReeMenuItem("../html/orderTraveInfoNew.html?id=" + sid + "&ascription=1", "蚂蜂窝new出行人信息");

            } else if (status == 2) {
                // 新美大
                addReeMenuItem("../html/orderTraveInfo.html?id=" + sid + "&ascription=2", "新美大出行人信息");
            } else if (status == 0) {
                // luways
                addReeMenuItem("../html/orderTraveOur.html?id=" + sid, "luways出行人信息");
            } else if (status == 1) {
                // 蚂蜂窝
                addReeMenuItem("../html/orderTraveInfoNew.html?id=" + sid + "&ascription=1", "蚂蜂窝new出行人信息");
            }
        }




        $(function () {
            // var Table = new TableInit(columns);
            Table();
            var oButtonInit = new ButtonInit();
            oButtonInit.Init();
            $('.i_check').iCheck({
                handler: 'radio',
                radioClass: 'iradio_square-green',
                increaseArea: '20%',
            });


            //按钮权限
            var resourcesData = getUserInfo().roles[0].resources
            var resourcesHtml = []
            for (item in resourcesData) {
                var activeDivObj = new Array();
                resourcesHtml.push(activeDivObj)
                if (resourcesData[item].parent == 4) {
                    var addObj = {};
                    addObj.parent = resourcesData[item].permission
                    resourcesHtml[item].push(addObj)
                }
            }
            arrayHtml = new Array();
            for (i in resourcesHtml) {
                if (resourcesHtml[i] != '') {
                    arrayHtml.push(resourcesHtml[i][0].parent)
                }
            }
            console.log(arrayHtml)
            /*if ($.inArray("100003005",arrayHtml) !== -1){
            $("#toolbar").show()
        }
*/

        });

        function downWoad() {
            // window.location.href= ''
        }


        //   =================== 文档上传
        function uploadWord(orderNo, orderFrom) {
            console.log(orderNo)
            console.log(orderFrom)
            $("#orderNoFile").val(orderNo)
            $("#orderFromFile").val(orderFrom)
            $(".wordForm input").click();
        }
        /*--------------文档上传-----------*/
        $(".wordForm input").change(function () {
            var index = layer.load(1, {
                time: 1 * 500
            });
            // $('#wordCover').val($(this).val());
            var formData = new FormData($(this).parent()[0]);
            $.ajax({
                url: uploadFile, //Server script to process data
                type: 'POST',
                data: formData,
                sync: false,
                cache: false,
                contentType: false,
                processData: false,
                beforeSend: function (request) {
                    // console.log('loading...');
                    // request.setRequestHeader('Access-Control-Allow-Headers:x-requested-with',
                    // 'content-type');
                    // request.setRequestHeader('Access-Control-Allow-Methods:POST');
                    // request.setRequestHeader('Access-Control-Allow-Origin:*');
                },
                dataType: "json",
                success: function (result) {
                    console.log(result)
                    if (result.success) {
                        layer.msg('上传成功！', {
                            icon: 1
                        });
                        handleTable("", 3, adminOrderRestfulControllerList);
                        formReset()

                    } else {
                        layer.msg('上传失败！', {
                            icon: 2,
                            time: 1000,
                            shade: 0.01
                        });
                    }

                },

                error: function () {
                    layer.msg('上传失败！', {
                        icon: 2,
                        time: 1000,
                        shade: 0.01
                    });
                }
            });
            // (function ($) {
            //     $.ajax({
            //         type: "post",
            //         url: uploadFile,
            //         data: formData,
            //         dataType: 'jsonp',
            //         sync: false,
            //         cache: false,
            //         contentType: false,
            //         processData: false,
            //         jsonpCallback: 'callback',
            //         success: function (result) {
            //             console.log(result)
            //             if (result.success) {
            //                 layer.msg('上传成功！', {
            //                     icon: 1
            //                 });
            //                 handleTable("", 3, adminOrderRestfulControllerList);
            //                 formReset()

            //             } else {
            //                 layer.msg('上传失败！', {
            //                     icon: 2,
            //                     time: 1000,
            //                     shade: 0.01
            //                 });
            //             }

            //         },
            //         error: function (XMLHttpRequest, textStatus, errorThrown) {
            //             alert(XMLHttpRequest.status);
            //             alert(XMLHttpRequest.readyState);
            //             alert(textStatus);
            //         }
            //     });
            // })(jQuery)
        })
        // 表单  刷新
        function formReset() {
            $(".wordForm")[0].reset();
        }

        function openPOP() {
            addOrEdit();
        }

        function reInitTable() {
            $table.bootstrapTable('refresh');
        }
        //初始化页面上面的按钮事件
        var ButtonInit = function () {
            var oInit = new Object();
            oInit.Init = function () {
                $('#btn_add').click(openPOP);
                $('#btn_search').click(reInitTable);

            };
            laydate.render({
                elem: '#startTime',
                type: 'datetime'
            });
            laydate.render({
                elem: '#endTime',
                type: 'datetime'
            });
            return oInit;

        };
    </script>
</body>

</html>